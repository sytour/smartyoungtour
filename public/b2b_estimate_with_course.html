<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>B2B 견적 요청 입력</title>
  <style>
    body { font-family: Arial, sans-serif; background-color: #fffaf0; margin: 0; padding: 40px; display: flex; justify-content: center; }
    .container { width: 100%; max-width: 900px; }
    h2 { text-align: center; margin-bottom: 30px; }
    .section { background: #fff; padding: 20px; margin-bottom: 20px; border: 1px solid #ddd; border-radius: 10px; }
    label { display: block; margin-top: 12px; font-weight: bold; }
    input, select { width: 100%; padding: 10px; margin-top: 6px; border: 1px solid #ccc; border-radius: 6px; }
    .checkbox-label { display: flex; align-items: center; gap: 6px; margin-top: 10px; }
    button { width: 100%; padding: 12px; font-size: 16px; background-color: #ff9800; color: white; border: none; border-radius: 8px; cursor: pointer; }
    button:hover { background-color: #e68900; }
  </style>
</head>
<body>
  <div class="container">
    <h2>B2B 견적 요청 입력</h2>

    <div class="section" id="courseInfoSection">
      <p><strong>선택한 국가:</strong> <span id="countryName">로딩 중...</span></p>
      <p><strong>선택한 코스:</strong> <span id="courseName">로딩 중...</span></p>
      <p><strong>일정 설정:</strong> <span id="itinerary">로딩 중...</span></p>
    </div>

    <div class="section" id="peopleSection">
      <label>총 인원 수</label>
      <input type="number" id="totalPeople" value="0">
    </div>

    <div class="section" id="hotelSection">
      <label>호텔 등급</label>
      <select id="hotelGrade">
        <option value="4성급">4성급</option>
        <option value="5성급">5성급</option>
      </select>
      <label>싱글룸 수</label><input type="number" id="roomSingle" value="0">
      <label>트윈룸 수</label><input type="number" id="roomTwin" value="0">
      <label>더블룸 수</label><input type="number" id="roomDouble" value="0">
      <label>트리플룸 수</label><input type="number" id="roomTriple" value="0">
      <p style="color: gray;">※ 트윈과 더블은 호텔 사정에 따라 상이할 수 있습니다.</p>
    </div>

    <div class="section" id="vehicleSection">
      <label>차량 종류</label>
      <p>※ 인원 수에 따라 자동 선택됩니다 (6명 이하: 벤, 7~11명: 미니버스, 12명 이상: 버스)</p>
      <div id="vehicleResult">자동 계산됨</div>
    </div>

    <div class="section" id="mealSection">
      <label id="mealLabel">식사 구성</label>
      <div id="mealInfo">중식 및 석식이 자동 포함됩니다.</div>
    </div>

    <div class="section" id="optionSection">
      <label>선택관광 포함 여부</label>
      <select id="optionalTour">
        <option value="Y">포함</option>
        <option value="N">불포함</option>
      </select>
      <label>쇼핑 횟수</label>
      <select id="shoppingCount">
        <option value="0">노쇼핑</option>
        <option value="1">1회</option>
        <option value="2">2회</option>
        <option value="3">3회</option>
      </select>
    </div>

    <div class="section">
      <label>총 지상비 (전체)</label>
      <input type="text" id="totalGroundCost" readonly>
      <label>성인 1인 지상비 (p/p)</label>
      <input type="text" id="perPersonCost" readonly>
    </div>

    <div class="section">
      <button onclick="calculateEstimate()">총액 계산</button>
    </div>

    <div class="section">
      <button onclick="generatePDF()">PDF 견적서 출력</button>
    </div>
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const course = decodeURIComponent(urlParams.get('course') || '');
    const country = decodeURIComponent(urlParams.get('country') || '');
    const itinerary = decodeURIComponent(urlParams.get('itinerary') || '');

    document.getElementById('countryName').innerText = country;
    document.getElementById('courseName').innerText = course;
    document.getElementById('itinerary').innerText = itinerary;

    const mealLabel = document.getElementById('mealLabel');
    const mealInfo = document.getElementById('mealInfo');

    if (course.includes("골프")) {
      mealLabel.innerText = "골프 투어 식사 설정";
      mealInfo.innerHTML = `
        <label>중식 포함 여부</label>
        <select id="lunchIncluded">
          <option value="Y">포함</option>
          <option value="N">불포함</option>
        </select>
        <label>석식 포함 여부</label>
        <select id="dinnerIncluded">
          <option value="Y">포함</option>
          <option value="N">불포함</option>
        </select>
      `;
    } else {
      mealLabel.innerText = "식사 구성 (일반 투어 - 자동 포함)";
      mealInfo.innerHTML = `
        중식 및 석식이 자동 포함됩니다.
        <label class="checkbox-label">
          <input type="checkbox" id="lateArrivalDinner" />
          낮 비행기 도착 선택 시 석식 포함
        </label>
      `;
    }

    function calculateEstimate() {
      const s = parseInt(document.getElementById('roomSingle').value) || 0;
      const t = parseInt(document.getElementById('roomTwin').value) || 0;
      const d = parseInt(document.getElementById('roomDouble').value) || 0;
      const tr = parseInt(document.getElementById('roomTriple').value) || 0;
      const totalInput = parseInt(document.getElementById('totalPeople').value) || 0;
      const totalCalc = s + (t * 2) + (d * 2) + (tr * 3);

      if (totalInput !== totalCalc) {
        alert(`❌ 방 인원수 총합(${totalCalc})이 입력한 총 인원수(${totalInput})와 일치하지 않습니다.`);
        return;
      }

      let vehicle = '벤';
      if (totalInput > 6 && totalInput <= 11) vehicle = '미니버스';
      else if (totalInput >= 12) vehicle = '버스';
      document.getElementById('vehicleResult').innerText = `${vehicle} (자동 선택됨)`;

      // 예시: 지상비 계산 (고정값 × 인원)
      const groundUnitPrice = 1000000; // 테스트용 단가
      const totalCost = totalInput * groundUnitPrice;
      document.getElementById('totalGroundCost').value = totalCost.toLocaleString() + '원';
      document.getElementById('perPersonCost').value = groundUnitPrice.toLocaleString() + '원';
    }

    function generatePDF() {
      alert('PDF 견적서 생성 기능은 준비 중입니다.');
    }
  </script>
</body>
</html>
